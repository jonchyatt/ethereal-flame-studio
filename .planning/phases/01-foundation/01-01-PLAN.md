---
phase: 01-foundation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - tsconfig.json
  - next.config.ts
  - tailwind.config.ts
  - postcss.config.mjs
  - src/app/layout.tsx
  - src/app/page.tsx
  - src/app/globals.css
  - src/types/index.ts
  - .gitignore
  - README.md
autonomous: true

must_haves:
  truths:
    - "npm run dev starts a Next.js development server"
    - "Browser shows a black canvas with Three.js scene"
    - "TypeScript compilation succeeds with no errors"
  artifacts:
    - path: "package.json"
      provides: "Project dependencies including Next.js 15, React 19, R3F v9, Three.js"
      contains: "@react-three/fiber"
    - path: "src/app/page.tsx"
      provides: "Main page with R3F Canvas component"
      contains: "Canvas"
    - path: "next.config.ts"
      provides: "Next.js configuration with transpilePackages"
      contains: "transpilePackages"
  key_links:
    - from: "src/app/page.tsx"
      to: "@react-three/fiber"
      via: "Canvas import"
      pattern: "import.*Canvas.*@react-three/fiber"
---

<objective>
Scaffold Next.js 15 + React Three Fiber v9 project with TypeScript and Tailwind CSS.

Purpose: Establish the foundational project structure that all subsequent plans build upon. This creates the development environment, package dependencies, and basic R3F canvas that will host the particle system and skybox.

Output: Working Next.js development server with a black 3D canvas visible in browser.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-foundation/01-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Initialize Next.js 15 project with dependencies</name>
  <files>
    - package.json
    - tsconfig.json
    - next.config.ts
    - tailwind.config.ts
    - postcss.config.mjs
    - .gitignore
  </files>
  <action>
Create a new Next.js 15 project with App Router:

1. Initialize package.json with these exact dependencies:
   - next@latest (15.x)
   - react@latest (19.x)
   - react-dom@latest (19.x)
   - three@latest (0.181+)
   - @react-three/fiber@latest (9.x)
   - @react-three/drei@latest (10.x)
   - zustand@latest (5.x)
   - tailwindcss@latest (4.x)
   - typescript@latest (5.x)

   DevDependencies:
   - @types/react
   - @types/react-dom
   - @types/three

2. Create tsconfig.json with strict mode enabled, paths alias for "@/*" pointing to "src/*"

3. Create next.config.ts with:
   - transpilePackages: ['three'] (critical for R3F compatibility)

4. Create tailwind.config.ts with content paths for src/**/*.tsx

5. Create postcss.config.mjs with tailwindcss plugin

6. Create .gitignore with node_modules, .next, .env*, etc.

Run npm install after creating package.json.
  </action>
  <verify>
    npm install completes without errors
    npm run build (or npx tsc --noEmit) shows no TypeScript errors
  </verify>
  <done>
    package.json exists with all required dependencies installed
    TypeScript config is strict with path aliases
    Tailwind CSS is configured
  </done>
</task>

<task type="auto">
  <name>Task 2: Create application shell with R3F Canvas</name>
  <files>
    - src/app/layout.tsx
    - src/app/page.tsx
    - src/app/globals.css
    - src/types/index.ts
    - README.md
  </files>
  <action>
1. Create src/app/globals.css with:
   - Tailwind directives (@tailwind base, components, utilities)
   - html, body { margin: 0; padding: 0; overflow: hidden; }
   - #__next, main { width: 100vw; height: 100vh; }

2. Create src/app/layout.tsx:
   - Import globals.css
   - Metadata with title "Ethereal Flame Studio"
   - Full-height body wrapper

3. Create src/app/page.tsx:
   - "use client" directive (R3F requires client component)
   - Import Canvas from @react-three/fiber
   - Import OrbitControls from @react-three/drei
   - Render full-screen Canvas with:
     - camera: { position: [0, 0.5, 3], fov: 60 }
     - dpr: [1, 2] (cap pixel ratio for mobile performance)
     - gl: { antialias: true, powerPreference: 'high-performance' }
   - Inside Canvas: OrbitControls and a simple mesh (box or sphere) as placeholder
   - Black background color via Canvas style or scene background

4. Create src/types/index.ts with placeholder type exports (will be extended in later plans)

5. Update README.md with:
   - Project name and description
   - npm run dev to start
   - Tech stack summary
  </action>
  <verify>
    npm run dev starts server on localhost:3000
    Browser shows black canvas with 3D object
    OrbitControls allow rotating/zooming the view
  </verify>
  <done>
    Next.js app shell renders in browser
    R3F Canvas displays with working orbit controls
    No console errors related to React 19 / R3F v9 compatibility
  </done>
</task>

</tasks>

<verification>
1. Run `npm run dev` and verify server starts
2. Open http://localhost:3000 in browser
3. Verify black canvas fills viewport
4. Verify mouse drag rotates camera
5. Run `npx tsc --noEmit` to verify TypeScript compilation
6. Check browser console for any errors
</verification>

<success_criteria>
- Next.js 15 + React 19 + R3F v9 project runs without errors
- Full-screen black Canvas visible in browser
- OrbitControls work (drag to rotate, scroll to zoom)
- TypeScript strict mode compiles successfully
- Ready as foundation for audio analyzer and particle system
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation/01-01-SUMMARY.md`
</output>
