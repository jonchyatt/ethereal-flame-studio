# =============================================================================
# Ethereal Flame Studio - Production Environment Configuration
# =============================================================================
# Copy this file to .env and configure all required values
# NEVER commit .env to version control (it contains secrets)
# =============================================================================

# -----------------------------------------------------------------------------
# MACHINE IDENTIFICATION (for multi-machine render farm)
# -----------------------------------------------------------------------------
# Unique identifier for this render machine
# Used in health checks, logging, and n8n job routing
# Examples: desktop, laptop, render-node-1
MACHINE_ID=desktop

# -----------------------------------------------------------------------------
# CLOUDFLARE TUNNEL (required for remote access)
# -----------------------------------------------------------------------------
# Get token from: Cloudflare Dashboard > Zero Trust > Networks > Tunnels
# 1. Create tunnel named "ethereal-flame-{machine_id}"
# 2. Copy the tunnel token (starts with 'eyJ...')
# 3. Configure public hostnames in tunnel settings:
#    - n8n.yourdomain.com -> http://n8n:5678
#    - render-{machine_id}.yourdomain.com -> http://render-worker:3000
CLOUDFLARE_TUNNEL_TOKEN=your_tunnel_token_here

# -----------------------------------------------------------------------------
# REDIS CONFIGURATION
# -----------------------------------------------------------------------------
# Port for Redis (default: 6379)
REDIS_PORT=6379

# Redis password (optional but recommended for production)
# Leave empty for no authentication
REDIS_PASSWORD=

# -----------------------------------------------------------------------------
# N8N CONFIGURATION (workflow automation)
# -----------------------------------------------------------------------------
# Public hostname for n8n (must match Cloudflare Tunnel config)
N8N_HOST=n8n.yourdomain.com

# Full webhook URL (used for external integrations)
N8N_WEBHOOK_URL=https://n8n.yourdomain.com/

# n8n web interface port (internal)
N8N_PORT=5678

# n8n authentication (REQUIRED - protect your workflows)
N8N_BASIC_AUTH_ACTIVE=true
N8N_USER=admin
N8N_PASSWORD=change_this_to_a_strong_password

# Maximum webhook payload size in MB (increase for large video metadata)
N8N_PAYLOAD_SIZE_MAX=100

# Execution data retention (all = keep everything for debugging)
# Options: all, none
N8N_SAVE_SUCCESS_EXECUTIONS=all
N8N_SAVE_ERROR_EXECUTIONS=all

# Database type (sqlite for simple setup, postgres for scale)
# Options: sqlite, postgresdb
N8N_DB_TYPE=sqlite

# Encryption key for stored credentials
# Generate with: openssl rand -hex 32
# CRITICAL: Back up this key! Lost key = lost credentials
N8N_ENCRYPTION_KEY=

# -----------------------------------------------------------------------------
# WHISPER TRANSCRIPTION SERVICE
# -----------------------------------------------------------------------------
# Whisper service port
WHISPER_PORT=9000

# Model to use (larger = more accurate, more VRAM)
# Options: tiny, base, small, medium, large-v3
# VRAM requirements: tiny=1GB, small=2GB, medium=5GB, large-v3=4.5GB (fp16)
WHISPER_MODEL=large-v3

# Compute device
# Options: cuda (GPU), cpu
WHISPER_DEVICE=cuda

# Compute type (trade accuracy for speed/memory)
# Options: float16 (recommended), int8 (faster, less VRAM), float32 (most accurate)
WHISPER_COMPUTE_TYPE=float16

# Beam size for transcription (higher = more accurate, slower)
WHISPER_BEAM_SIZE=5

# Default language (leave blank for auto-detection)
# Use ISO 639-1 codes: en, es, fr, de, ja, zh, etc.
WHISPER_LANGUAGE=en

# -----------------------------------------------------------------------------
# RENDER WORKER CONFIGURATION
# -----------------------------------------------------------------------------
# Render API port
RENDER_API_PORT=3000

# Maximum concurrent render jobs (usually 1 per GPU)
QUEUE_CONCURRENCY=1

# Job timeout in milliseconds (1 hour = 3600000)
JOB_TIMEOUT_MS=3600000

# Default template for rendering
DEFAULT_TEMPLATE=ethereal-flame

# n8n webhook for render completion notifications
# Create webhook in n8n: Webhook node with path "/render-complete"
N8N_RENDER_COMPLETE_WEBHOOK=https://n8n.yourdomain.com/webhook/render-complete

# Shared secret for webhook authentication
# Generate with: openssl rand -hex 32
N8N_WEBHOOK_SECRET=

# -----------------------------------------------------------------------------
# FILE PATHS (adjust for your system)
# -----------------------------------------------------------------------------
# Directory for rendered video output
# This path is on the HOST machine, mounted into containers
RENDER_OUTPUT_DIR=/path/to/renders

# Directory for input audio files
AUDIO_INPUT_DIR=/path/to/audio

# rclone configuration directory (for Google Drive sync)
RCLONE_CONFIG_DIR=/path/to/config

# -----------------------------------------------------------------------------
# GOOGLE DRIVE SYNC (via rclone)
# -----------------------------------------------------------------------------
# Enable automatic sync to Google Drive after render
GDRIVE_ENABLED=false

# Remote path in Google Drive (after rclone remote name)
# Full path becomes: gdrive:EtherealFlame/Renders
GDRIVE_REMOTE_PATH=EtherealFlame/Renders

# -----------------------------------------------------------------------------
# NOTIFICATIONS
# -----------------------------------------------------------------------------
# Enable ntfy push notifications
NTFY_ENABLED=false

# ntfy server URL (use ntfy.sh for public, or self-host)
NTFY_URL=https://ntfy.sh

# ntfy topic for render notifications
# Subscribe to this topic in the ntfy app
NTFY_TOPIC=ethereal-renders

# -----------------------------------------------------------------------------
# TIMEZONE
# -----------------------------------------------------------------------------
# Timezone for logging and scheduled tasks
# See: https://en.wikipedia.org/wiki/List_of_tz_database_time_zones
TZ=America/Los_Angeles

# =============================================================================
# OPTIONAL: MULTI-MACHINE RENDER FARM
# =============================================================================
# For additional render machines, create separate .env files:
# - .env.desktop (MACHINE_ID=desktop, unique tunnel token)
# - .env.laptop (MACHINE_ID=laptop, unique tunnel token)
#
# Run with:
#   docker compose -f docker-compose.production.yml --env-file .env.desktop up -d
# =============================================================================
